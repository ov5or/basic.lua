local configs = {
    main = {
        enabled = true,
        aimlockkey = "q",
        prediction = 0.15634,
        aimpart = 'HumanoidRootPart',
        notifications = true
    }
}

local boxsettings = {
    box = {
        Showbox = true,
        boxsize = Vector3.new(3.3, 3, 2.8), -- Box Size
        markercolor = Color3.fromRGB(255, 255, 255),
        markersize = UDim2.new(1, 0, 1, 0)
    }
}

local box = Instance.new("Part", game.Workspace)
box.Material = Enum.Material.ForceField
box.Color = Color3.fromRGB(199, 110, 255)
 
local Mouse = game.Players.LocalPlayer:GetMouse()
 
function makemarker(Parent, Adornee, Color, Size, Size2)
    local box = Instance.new("BillboardGui", Parent)
    box.Name = "Skidded"
    box.Adornee = Adornee
    box.Size = UDim2.new(Size, Size2, Size, Size2)
    box.AlwaysOnTop = true
    local a = Instance.new("Frame", box)
    a.Size = boxsettings.box.markersize
    a.BackgroundColor3 = Color
 
    local g = Instance.new("UICorner", a)
    g.CornerRadius = UDim.new(50, 50)
    return (box)
end
 
local Plr
 
local highlight = Instance.new("Highlight")
highlight.FillColor = Color3.fromRGB(199, 110, 255)
highlight.Parent = game.CoreGui
highlight.OutlineTransparency = 0
highlight.OutlineColor = Color3.new(1, 1, 1)
highlight.FillTransparency = 0.5
 
local line = Drawing.new("Line")
line.Visible = true
line.Color = Color3.fromRGB(199, 110, 255)
line.Thickness = 2
line.Transparency = 1
 
function FindClosestUser()
    local closestPlayer
    local ShortestDistance = 300
 
    for i, v in pairs(game.Players:GetPlayers()) do
        if v ~= game.Players.LocalPlayer and v.Character and v.Character:FindFirstChild("Humanoid") and
            v.Character.Humanoid.Health ~= 0 and v.Character:FindFirstChild("HumanoidRootPart") then
            local pos = game:GetService "Workspace".CurrentCamera:WorldToViewportPoint(v.Character.PrimaryPart.Position)
            local magnitude = (Vector2.new(pos.X, pos.Y) -
                                  Vector2.new(game.Players.LocalPlayer:GetMouse().X,
                    game.Players.LocalPlayer:GetMouse().Y)).magnitude
            if magnitude < ShortestDistance then
                closestPlayer = v
                ShortestDistance = magnitude
            end
        end
    end
    return closestPlayer
end

Mouse.KeyDown:Connect(function(KeyPressed)
    if KeyPressed == (configs.main.aimlockkey) then
        if configs.main.enabled == true then
            configs.main.enabled = false
            if configs.main.notifications == true then
                Plr = FindClosestUser()
                Notify("tapbot.cc", "Unlocked", 1.5)
            end
            highlight.Adornee = game.CoreGui
        else
            Plr = FindClosestUser()
            configs.main.enabled = true
            if configs.main.notifications == true then
                Notify("tapbot.cc", "Locking on target: " .. Plr.Character.Humanoid.DisplayName, 1.5)
            end
            highlight.Adornee = Plr.Character
        end
    end
end)

game:GetService "RunService".Stepped:connect(function()
    if configs.main.enabled and Plr.Character and Plr.Character:FindFirstChild("HumanoidRootPart") then
        local aimPosition = game.Players.LocalPlayer:FindFirstChild("PlayerGui")
        and game.Players.LocalPlayer.PlayerGui:FindFirstChild("MainScreenGui")
        and game.Players.LocalPlayer.PlayerGui.MainScreenGui:FindFirstChild("Aim")
        and game.Players.LocalPlayer.PlayerGui.MainScreenGui.Aim.AbsolutePosition
        local cursorOffset = Vector2.new(0, 40)
        box.CFrame = CFrame.new(Plr.Character[configs.main.aimpart].Position +
                                    (Plr.Character.UpperTorso.Velocity * configs.main.prediction))
        local Vector1 = camera:WorldToViewportPoint(Plr.Character.HumanoidRootPart.Position)
        line.Visible = true
        line.From = Vector2.new(Vector1.X, Vector1.Y)
        line.To = aimPosition + cursorOffset
    else
        local aimPosition = game.Players.LocalPlayer:FindFirstChild("PlayerGui")
        and game.Players.LocalPlayer.PlayerGui:FindFirstChild("MainScreenGui")
        and game.Players.LocalPlayer.PlayerGui.MainScreenGui:FindFirstChild("Aim")
        and game.Players.LocalPlayer.PlayerGui.MainScreenGui.Aim.AbsolutePosition
        local cursorOffset = Vector2.new(0, 40)
        box.CFrame = CFrame.new(0, 9999, 0)
        line.Visible = false
        line.From = Vector2.new(0,0)
        line.To = Vector2.new(0,0)
    end
end)

repeat
    wait()
until game:IsLoaded()
local mt = getrawmetatable(game)
local old = mt.__namecall
setreadonly(mt, false)
mt.__namecall = newcclosure(function(...)
    local args = {...}
    if configs.main.enabled and getnamecallmethod() == "FireServer" and args[2] == "UpdateMousePos" then
        args[3] = Plr.Character[configs.main.aimpart].Position +
                  (Plr.Character[configs.main.aimpart].Velocity * configs.main.prediction)
        return old(unpack(args))
    end
    return old(...)
end)
